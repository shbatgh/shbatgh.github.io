<div class="notes-explorer">
  <h3>Notes Explorer</h3>
  <div class="search-box">
    <input type="text" id="note-search" placeholder="Search notes...">
  </div>
  <div id="notes-tree">
    <!-- Dynamically filled by JavaScript -->
    <p>Loading notes...</p>
  </div>
</div>

<script>
// Simplified version - in production you'd fetch this data properly
async function loadNotes() {
  try {
    const response = await fetch('/notes/static/contentIndex.json');
    const data = await response.json();
    
    const notesTree = document.getElementById('notes-tree');
    notesTree.innerHTML = '';
    
    // Organize by folders
    const folders = {};
    for (const [id, note] of Object.entries(data)) {
      const path = note.path.split('/');
      const folder = path.length > 1 ? path[0] : 'root';
      
      if (!folders[folder]) folders[folder] = [];
      folders[folder].push(note);
    }
    
    // Create folder structure
    for (const [folder, notes] of Object.entries(folders)) {
      const folderEl = document.createElement('details');
      folderEl.innerHTML = `<summary>${folder === 'root' ? 'General Notes' : folder}</summary>`;
      const notesList = document.createElement('ul');
      
      notes.forEach(note => {
        const noteItem = document.createElement('li');
        const noteLink = document.createElement('a');
        noteLink.href = `/notes/${note.slug}`;
        noteLink.textContent = note.title || note.path;
        noteItem.appendChild(noteLink);
        notesList.appendChild(noteItem);
      });
      
      folderEl.appendChild(notesList);
      notesTree.appendChild(folderEl);
    }
    
    // Add search functionality
    const searchBox = document.getElementById('note-search');
    searchBox.addEventListener('input', (e) => {
      const query = e.target.value.toLowerCase();
      document.querySelectorAll('#notes-tree li').forEach(item => {
        const noteTitle = item.textContent.toLowerCase();
        item.style.display = noteTitle.includes(query) ? '' : 'none';
      });
      
      // Open all folders when searching
      if (query) {
        document.querySelectorAll('#notes-tree details').forEach(detail => {
          detail.open = true;
        });
      }
    });
    
  } catch (error) {
    console.error('Error loading notes:', error);
    document.getElementById('notes-tree').innerHTML = '<p>Error loading notes. Please try again later.</p>';
  }
}

document.addEventListener('DOMContentLoaded', loadNotes);
</script>

<style>
.notes-explorer {
  border: 1px solid #eaeaea;
  border-radius: 8px;
  padding: 1rem;
  margin: 2rem 0;
}

.search-box {
  margin-bottom: 1rem;
}

.search-box input {
  width: 100%;
  padding: 0.5rem;
  border: 1px solid #ddd;
  border-radius: 4px;
}

#notes-tree ul {
  padding-left: 1.5rem;
}

#notes-tree li {
  margin: 0.5rem 0;
}

details summary {
  cursor: pointer;
  font-weight: bold;
  padding: 0.5rem 0;
}
</style>